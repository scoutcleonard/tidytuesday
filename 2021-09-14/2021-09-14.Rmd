---
title: "Tidy Tuesday 2021-09-14"
author: "Scout Leonard"
date: "9/15/2021"
output: 
  html_document:
   theme: flatly
   code_folding: show
   toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

library(lubridate)
library(tidytuesdayR)
library(tidyverse)
library(skimr)
library(paletteer)
```

These Tidy Tuesday analyses and visualizations come from the [Tidy Tuesday Github repository for September 14, 2021](https://github.com/rfordatascience/tidytuesday/tree/master/data/2021/2021-09-14). The data in the repository comes from [Data.World](Data.World) through Sean Miller, [Billboard.com](Billboard.com) and Spotify. 

# Read in Data

```{r results='hide'}
#read in the data
tuesdata <- tidytuesdayR::tt_load('2021-09-14')
```

```{r}
audio_features <- tuesdata$audio_features
```

# Wrangle the `audio_features` dataframe for Taylor Swift data

```{r}
#create a taylor swift subset
tswift_data <- audio_features %>% 
  filter(performer == "Taylor Swift") %>% 
  filter(spotify_track_album == "Taylor Swift" |
           spotify_track_album == "Fearless" | 
           spotify_track_album == "Speak Now" | 
           spotify_track_album == "Red" | 
           spotify_track_album == "1989" | 
           spotify_track_album == "reputation" | 
           spotify_track_album == "Lover" | 
           grepl("folklore", spotify_track_album) | 
           grepl("evermore", spotify_track_album)) 

tswift_data <- tswift_data %>% 
  mutate(spotify_track_album = case_when(
    str_detect(spotify_track_album, "folklore") ~ "folklore",
    str_detect(spotify_track_album, "evermore") ~ "evermore",
    TRUE ~ spotify_track_album
  ))
```


```{r}
data_by_album <- tswift_data %>%
  group_by(spotify_track_album) %>% 
  summarise(mean_danceability = mean(danceability),
            mean_energy = mean(energy),
            mean_key = mean(key),
            mean_loudness = mean(loudness),
            mean_speechiness = mean(speechiness),
            mean_acousticness = mean(acousticness),
            mean_instrumentalness = mean(instrumentalness),
            mean_liveness = mean(liveness),
            mean_valence =  mean(valence),
            mean_tempo = mean(tempo))

data_by_album$spotify_track_album = factor(data_by_album$spotify_track_album,
                                           levels = c("Taylor Swift",
                                                      "Fearless",
                                                      "Speak Now",
                                                      "Red",
                                                      "1989",
                                                     "reputation",
                                                     "Lover",
                                                     "folklore",
                                                     "evermore"))
```

## Data Viz

I used the Google Chrome plugin "color picker," to pick colors from the album are of each of Taylor's albumn for use in these data visualizations. If you don't like the color schemes, you'll have to talk to the Swift franchise; sorry! 
```{r}
album_cols <- c("#0BA5D7", "#D8BD7D", "#7D4884", "#AE1848", "#96818F", "#0A0A0A", "#FEB5DC", "#919191", "#D85F2E")
```


```{r}
danceability <- ggplot(data = data_by_album, aes(x = spotify_track_album, y = mean_danceability)) +
  geom_histogram(stat = "identity", aes(fill = spotify_track_album)) +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(title = "Danceability of Taylor Swift Albums",
       x = "Album Title",
       y = "Mean Danceability") +
  scale_fill_manual(values = album_cols)

danceability
```
```{r}
energy <- ggplot(data = data_by_album, aes(x = spotify_track_album, y = mean_energy)) +
  geom_histogram(stat = "identity", aes(fill = spotify_track_album)) +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(title = "Energy of Taylor Swift Albums",
       x = "Album Title",
       y = "Mean Energy") +
  scale_fill_manual(values = album_cols)

energy
```

```{r}
key <- ggplot(data = data_by_album, aes(x = spotify_track_album, y = mean_key)) +
  geom_histogram(stat = "identity", aes(fill = spotify_track_album)) +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(title = "Key of Taylor Swift Albums",
       x = "Album Title",
       y = "Mean Key") +
  scale_fill_manual(values = album_cols)

key
```

```{r}
loudness <- ggplot(data = data_by_album, aes(x = spotify_track_album, y = mean_loudness)) +
  geom_histogram(stat = "identity", aes(fill = spotify_track_album)) +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(title = "Loudness of Taylor Swift Albums",
       x = "Album Title",
       y = "Mean Loudness") +
  scale_fill_manual(values = album_cols)

loudness
```
```{r}
speechiness <- ggplot(data = data_by_album, aes(x = spotify_track_album, y = mean_speechiness)) +
  geom_histogram(stat = "identity", aes(fill = spotify_track_album)) +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(title = "Speechiness of Taylor Swift Albums",
       x = "Album Title",
       y = "Mean Speechiness") +
  scale_fill_manual(values = album_cols)

speechiness
```

```{r}
ols_danceability <- lm(data = tswift_data, spotify_track_popularity ~ danceability)

ggplot(data = tswift_data, aes(x = danceability, y = spotify_track_popularity)) +
  geom_point(aes(color = spotify_track_album)) +
  geom_line(data = ols_danceability, aes(y = .fitted)) +
  theme_minimal() +
  labs(title = "Popularity of Taylor Swift Songs by Danceability",
       x = "Danceability",
       y = "Spotify Track Popularity")
```

```{r}
ols_tempo <- lm(data = tswift_data, spotify_track_popularity ~ tempo)

ggplot(data = tswift_data, aes(x = tempo, y = spotify_track_popularity)) +
  geom_point() +
  geom_line(data = ols_tempo, aes(y = .fitted))
```






