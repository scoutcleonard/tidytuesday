---
title: "tidy tuesday 2022-03-22"
author: "Scout Leonard"
date: "3/22/2022"
output: html_document
---

# Load Libraries 

```{r}
if (!require(librarian)) {
  install.packages("librarian")
  library(librarian)
}

shelf(tidyverse,
      here,
      janitor,
      lubridate,
      sf,
      leaflet,
      MetBrewer)
```

# Call Data

```{r}
tuesdata <- tidytuesdayR::tt_load('2022-08-02')

frogs <- tuesdata$frogs %>% 
  clean_names() %>% 
  mutate(survey_date = as.POSIXct(survey_date, format = '%m/%d/%Y')) %>% 
  st_as_sf(coords = c("utme_83", "utmn_83"), crs = 32610) %>% 
  st_transform(crs = 4326) %>% 
  mutate(lat = unlist(map(geometry, 2)),
         long = unlist(map(geometry, 1)),
         color = case_when(str_detect(detection, "No visual") ~ "grey",
                           str_detect(detection, "Captured") ~ "red",
                           str_detect(detection, "Visual") ~ "blue")) 
```

# Map

```{r}
frogs_map <- leaflet() %>% 
  fitBounds(lng1 = min(frogs$long - 0.01),
            lat1 = min(frogs$lat - 0.01),
            lng2 = max(frogs$long + 0.01),
            lat2 = max(frogs$lat + 0.01)) %>% 
  addProviderTiles("OpenTopoMap") %>% 
  addCircleMarkers(lng = frogs$long,
                   lat = frogs$lat,
                   popup = frogs$subsite,
                   color = (frogs$detection),
                   radius = 2) %>% 
  addLegend(position = "bottomleft",
            values = ~frogs$detection,
            pal = palPwr)
```


